<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Page9 - Happy Birthday My Favourite Panda üêº</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --slide-width: 1080px;
      --slide-duration: 2800ms; /* time each slide is visible */
      --fade-duration: 800ms;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background: #000;
      color: #fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow:hidden;
    }

    /* Top messages */
    .top-wrap{
      position: absolute;
      top:20px;
      width:100%;
      text-align:center;
      z-index: 30;
      pointer-events: none;
    }
    .top-line{
      font-weight:700;
      font-size:32px;
      text-shadow: 0 6px 18px rgba(0,0,0,0.8);
      margin:0;
      padding:0;
    }
    .sub-line{
      margin-top:6px;
      font-size:20px;
      opacity:0.95;
      font-weight:600;
      text-shadow: 0 6px 14px rgba(0,0,0,0.6);
    }

    /* slideshow container (center) */
    .stage {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%);
      width: var(--slide-width);
      max-width: calc(100% - 40px);
      height: auto;
      z-index: 10;
      pointer-events: none;
    }

    .slide {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: auto;
      opacity: 0;
      transition: opacity var(--fade-duration) ease-in-out, transform var(--fade-duration) ease-in-out;
      transform-origin: center center;
      will-change: opacity, transform;
      border-radius: 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      background: #111;
      overflow: hidden;
    }

    /* ensure img fits inside without cropping */
    .slide img{
      display:block;
      width:100%;
      height:auto;
      object-fit: contain; /* NO cropping */
    }

    .slide.active{
      opacity:1;
      transform: scale(1.02);
      pointer-events: none;
    }

    /* Effects canvas sits above slideshow but below UI elements */
    canvas#fx {
      position: fixed;
      left:0; top:0;
      width:100%;
      height:100%;
      z-index:25;
      pointer-events:none;
    }

    /* Floating emojis over slideshow/photo */
    .emoji {
      position: absolute;
      z-index:35;
      font-size: 34px;
      pointer-events:none;
      user-select:none;
      will-change: transform, opacity;
      animation-timing-function: linear;
    }

    /* Quiz box - centered and hidden until slideshow ends */
    .quiz {
      position: absolute;
      left:50%;
      top:50%;
      transform: translate(-50%,-50%);
      z-index:40;
      min-width: 320px;
      max-width: 90%;
      background: rgba(0,0,0,0.72);
      border: 2px solid rgba(255,255,255,0.06);
      backdrop-filter: blur(6px);
      color: #fff;
      padding: 22px;
      border-radius: 12px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.6);
      text-align:center;
      display:none; /* becomes visible after slideshow */
    }

    .quiz h3{
      margin: 0 0 10px 0;
      font-size:20px;
      color: #ffea6a;
      font-weight:800;
    }
    .quiz p{ margin:0 0 12px 0; color:#ffd; line-height:1.3; font-weight:700; }
    .quiz input{
      width: 80%;
      font-size:18px;
      padding:10px 12px;
      border-radius:8px;
      border: none;
      outline: none;
      text-align:center;
      margin-bottom:10px;
    }
    .quiz button{
      font-size:16px;
      padding:10px 16px;
      border-radius:8px;
      border:none;
      background: #ff5fa8;
      color:#fff;
      font-weight:700;
      cursor:pointer;
    }
    .quiz small{ display:block; margin-top:8px; color:#ddd; font-size:12px; }

    /* small responsive tweak */
    @media (max-width:520px){
      .top-line { font-size:20px; }
      .sub-line { font-size:16px; }
      .emoji { font-size:26px; }
    }

  </style>
</head>
<body>

  <!-- autoplay music -->
  <audio id="bgm" src="page9.mp3" loop playsinline></audio>

  <!-- top messages -->
  <div class="top-wrap">
    <div class="top-line">Happy Birthday My Favourite Panda üêº</div>
    <div class="sub-line">Ennoda Kolanthaaa Panda üòöü´∂</div>
    <div class="sub-line" style="font-size:16px; margin-top:6px;">En panda eppovum Happy ya erukanum</div>
  </div>

  <!-- slideshow stage -->
  <div class="stage" id="stage">
    <!-- slides: full-width images, no cropping - each inside .slide -->
    <!-- Images P1.jpg ... P15.jpg must exist in same folder -->
    <!-- order below must match your filenames -->
    <div class="slide active"><img src="P1.jpg" alt=""></div>
    <div class="slide"><img src="P2.jpg" alt=""></div>
    <div class="slide"><img src="P3.jpg" alt=""></div>
    <div class="slide"><img src="P4.jpg" alt=""></div>
    <div class="slide"><img src="P5.jpg" alt=""></div>
    <div class="slide"><img src="P6.jpg" alt=""></div>
    <div class="slide"><img src="P7.jpg" alt=""></div>
    <div class="slide"><img src="P8.jpg" alt=""></div>
    <div class="slide"><img src="P9.jpg" alt=""></div>
    <div class="slide"><img src="P10.jpg" alt=""></div>
    <div class="slide"><img src="P11.jpg" alt=""></div>
    <div class="slide"><img src="P12.jpg" alt=""></div>
    <div class="slide"><img src="P13.jpg" alt=""></div>
    <div class="slide"><img src="P14.jpg" alt=""></div>
    <div class="slide"><img src="P15.jpg" alt=""></div>
  </div>

  <!-- quiz (hidden until slideshow finishes) -->
  <div class="quiz" id="quiz">
    <h3>Quiz ‚Äî Ungaluku pudicha colour heart</h3>
    <p>Unnaku pudcha colour heart more than 10 type pannu next pola...</p>
    <input id="quizInput" placeholder="Type heart emojis (e.g. ‚ù§Ô∏èüíôüíö...)">
    <div>
      <button id="submitBtn">Submit</button>
    </div>
    <small>Type any colour heart emoji 10 or more times to move to next page</small>
  </div>

  <!-- canvas for confetti/fireworks -->
  <canvas id="fx"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    /*******************
     * Autoplay music (with mobile unlock fallback)
     *******************/
    const bgm = document.getElementById('bgm');
    function tryPlayMusic(){
      bgm.play().catch(()=> {
        const handler = () => { bgm.play(); window.removeEventListener('click', handler); window.removeEventListener('touchstart', handler); };
        window.addEventListener('click', handler);
        window.addEventListener('touchstart', handler);
      });
    }
    tryPlayMusic();

    /*******************
     * Floating emojis over stage
     *******************/
    const EMOJIS = ['üêº','ü´∂','üòö','‚ù§Ô∏è‚Äçü©π','üôà','üòä','ü•∞'];
    function spawnEmoji(){
      const el = document.createElement('div');
      el.className = 'emoji';
      el.innerText = EMOJIS[Math.floor(Math.random()*EMOJIS.length)];
      // place around the stage area (over the image)
      const stage = document.getElementById('stage');
      const rect = stage.getBoundingClientRect();
      const x = rect.left + Math.random()*(rect.width - 40);
      const y = rect.top - 60; // start above stage
      el.style.left = x + 'px';
      el.style.top = y + 'px';
      // random duration
      const dur = 3000 + Math.random()*4000;
      el.style.animationDuration = dur + 'ms';
      document.body.appendChild(el);
      setTimeout(()=> el.remove(), dur + 200);
    }
    // spawn continuously
    const emojiTimer = setInterval(spawnEmoji, 420);

    /*******************
     * Slideshow: show each slide for a while, fade transitions.
     * Run once through 15 slides and then stop and show quiz (centered)
     *******************/
    const slides = Array.from(document.querySelectorAll('.slide'));
    const slideCount = slides.length;
    const perSlide = 3000; // ms per slide visible
    let current = 0;

    function showSlide(i){
      slides.forEach((s, idx)=> {
        s.classList.toggle('active', idx === i);
      });
    }

    // advance through slides one by one
    function runSlideshowOnce(){
      let i = 0;
      showSlide(i); // ensure first visible
      const slideInterval = setInterval(()=>{
        i++;
        if(i < slideCount){
          showSlide(i);
        } else {
          clearInterval(slideInterval);
          // after last image, stop slideshow and reveal quiz
          setTimeout(() => {
            revealQuiz();
          }, 600); // tiny delay for final fade
        }
      }, perSlide);
    }
    // start slideshow after small initial delay
    setTimeout(runSlideshowOnce, 600);

    /*******************
     * Reveal quiz and play grand open effects
     *******************/
    const quizEl = document.getElementById('quiz');
    function revealQuiz(){
      // show quiz
      quizEl.style.display = 'block';
      quizEl.style.opacity = 0;
      quizEl.style.transition = 'opacity 700ms ease';
      setTimeout(()=> quizEl.style.opacity = 1, 30);

      // open page effects: confetti + fireworks
      launchGrandCelebration();
    }

    /*******************
     * Confetti & Fireworks (canvas-confetti)
     *******************/
    const confettiCanvas = document.getElementById('fx');

    // helper wrapper for canvas-confetti with canvas element
    const confettiInstance = confetti.create(confettiCanvas, { resize: true, useWorker: true });

    function launchGrandCelebration(){
      // big multi-direction bursts
      const duration = 3000;
      const end = Date.now() + duration;

      (function frame(){
        confettiInstance({
          particleCount: 20,
          spread: 160,
          startVelocity: 45,
          scalar: 1.1,
          ticks: 400,
          origin: { x: Math.random(), y: Math.random() * 0.2 }
        });
        confettiInstance({
          particleCount: 20,
          spread: 120,
          startVelocity: 35,
          scalar: 1.0,
          origin: { x: Math.random(), y: Math.random() * 0.2 }
        });
        if (Date.now() < end) requestAnimationFrame(frame);
      })();

      // a few "firework" style bursts from center
      for (let i=0;i<6;i++){
        setTimeout(()=> {
          confettiInstance({
            particleCount: 60,
            spread: 260,
            gravity: 0.6,
            startVelocity: 30,
            origin: { x: 0.5, y: 0.4 }
          });
        }, 300 + i*300);
      }
    }

    /*******************
     * Quiz submit: count heart emojis (many common hearts supported)
     *******************/
    const submitBtn = document.getElementById('submitBtn');
    const quizInput = document.getElementById('quizInput');

    // match common heart emojis / variations; add more if you like
    const HEART_REGEX = /‚ù§Ô∏è‚Äçü©π|‚ù§Ô∏è|üíô|üíö|üíõ|üíú|üß°|üíñ|üíó|üíì|üñ§|üíû|üíï|üíü|‚ù§/g;

    submitBtn.addEventListener('click', () => {
      const val = quizInput.value || '';
      const match = val.match(HEART_REGEX) || [];
      if (match.length >= 10) {
        // celebration
        confettiInstance({
          particleCount: 200,
          spread: 360,
          origin: { x: 0.5, y: 0.4 }
        });
        // small delay for effect then redirect
        setTimeout(()=> {
          window.location.href = 'Page10.html';
        }, 1100);
      } else {
        // subtle shake + small burst to indicate not enough
        quizEl.animate([{ transform: 'translateY(0)' }, { transform: 'translateY(-8px)' }, { transform: 'translateY(0)' }], { duration: 300, easing: 'ease' });
        confettiInstance({ particleCount: 10, spread: 40, origin: { x: 0.5, y: 0.6 } });
      }
    });

    // also allow pressing Enter
    quizInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') submitBtn.click();
    });

    /*******************
     * Clean up when page hidden (optional)
     *******************/
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        // pause music if tab hidden
        try { bgm.pause(); } catch(e){}
      } else {
        try { bgm.play().catch(()=>{}); } catch(e){}
      }
    });

  </script>
</body>
</html>
